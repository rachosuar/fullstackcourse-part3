{"ast":null,"code":"import _toConsumableArray from\"/Users/juan/Desktop/fullstackcourse/part3/phonebook/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/juan/Desktop/fullstackcourse/part3/phonebook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Contacts from\"./components/contacts\";import Filter from\"./components/filter\";import AddContact from\"./components/addcontact\";import phonebook from\"./services/phonebook\";import Notifications from\"./components/notification\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),newName=_useState4[0],setNewName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),newNumber=_useState6[0],setNewNumber=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),filterValue=_useState8[0],setFilterValue=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),newFilter=_useState10[0],setNewFilter=_useState10[1];var _useState11=useState({data:null,clases:\"\"}),_useState12=_slicedToArray(_useState11,2),message=_useState12[0],setMessage=_useState12[1];useEffect(function(){phonebook.getAll().then(function(response){setPersons(response);});},[]);var changeName=function changeName(event){setNewName(event.target.value);};var changeNumber=function changeNumber(event){setNewNumber(event.target.value);};var handleFilter=function handleFilter(event){setFilterValue(event.target.value);event.target.value?setNewFilter(true):setNewFilter(false);};var handleSubmit=function handleSubmit(event){event.preventDefault();var newPerson={name:newName,number:newNumber};if(persons.filter(function(person){return person.name.toLowerCase()===newName.toLowerCase();}).length>0&&persons.filter(function(person){return person.number===newNumber;}).length>0){setMessage({data:\"\".concat(newName,\" already exist\"),clases:\"message\"});setTimeout(function(){setMessage(null);},5000);}else if(persons.filter(function(person){return person.name.toLowerCase()===newName.toLowerCase();}).length>0&&window.confirm(\"\".concat(newName,\" already exist do you wish to change the number?\"))){var id=persons.filter(function(person){return newName.toLowerCase()===person.name.toLowerCase();})[0].id;phonebook.changePhone(id,newPerson).then(function(response){setPersons(persons.map(function(person){return person.id!==id?person:response;}));}).catch(function(err){return setMessage({data:\"\".concat(newName,\" has already been removed from server\"),clases:\"errorMessage\"});});setMessage({data:\"\".concat(newName,\" phone number was changed\"),clases:\"errorMessage\"});setTimeout(function(){setMessage(null);},5000);}if(persons.filter(function(person){return person.name.toLowerCase()===newName.toLowerCase();}).length==0){phonebook.newPerson(newPerson).then(function(response){if(response.name){setPersons([].concat(_toConsumableArray(persons),[response]));setMessage({data:\"\".concat(response.name,\" was added to the phonebook\"),clases:\"message\"});setTimeout(function(){setMessage(null);},5000);}else{setMessage({data:\"\".concat(response.error),clases:\"errorMessage\"});setTimeout(function(){setMessage(null);},7000);}});}};var filter=persons.filter(function(person){return person.name.slice(0,filterValue.length).toLowerCase()===filterValue.toLowerCase();});//\nvar contactToShow=newFilter?filter:persons;var _handleClick=function handleClick(person){var toDelete=[];if(window.confirm(\"delete \".concat(person.name,\"?\"))){toDelete=persons.slice(persons.indexOf(person),persons.indexOf(person)+1);setPersons(persons.filter(function(person){return person.id!==toDelete[0].id;}));phonebook.remove(toDelete[0].id);}setMessage({data:\"\".concat(toDelete[0].name,\" was deleted from phonebook\"),clases:\"errorMessage\"});setTimeout(function(){setMessage(null);},5000);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),message?/*#__PURE__*/_jsx(Notifications,{message:message.data,clases:message.clases}):/*#__PURE__*/_jsx(\"h2\",{children:\"Notifications\"}),/*#__PURE__*/_jsx(Filter,{handleFilter:handleFilter}),/*#__PURE__*/_jsx(\"h1\",{children:\"Add a new number\"}),/*#__PURE__*/_jsx(AddContact,{handleSubmit:handleSubmit,changeName:changeName,changeNumber:changeNumber}),/*#__PURE__*/_jsx(Contacts,{persons:contactToShow,handleClick:function handleClick(person){return _handleClick(person);}})]});};export default App;","map":{"version":3,"sources":["/Users/juan/Desktop/fullstackcourse/part3/phonebook/src/App.js"],"names":["React","useEffect","useState","Contacts","Filter","AddContact","phonebook","Notifications","App","persons","setPersons","newName","setNewName","newNumber","setNewNumber","filterValue","setFilterValue","newFilter","setNewFilter","data","clases","message","setMessage","getAll","then","response","changeName","event","target","value","changeNumber","handleFilter","handleSubmit","preventDefault","newPerson","name","number","filter","person","toLowerCase","length","setTimeout","window","confirm","id","changePhone","map","catch","err","error","slice","contactToShow","handleClick","toDelete","indexOf","remove"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Contacts from \"./components/contacts\";\nimport Filter from \"./components/filter\";\nimport AddContact from \"./components/addcontact\";\nimport phonebook from \"./services/phonebook\";\nimport Notifications from \"./components/notification\";\n\nconst App = () => {\n  const [persons, setPersons] = useState([]);\n  const [newName, setNewName] = useState(\"\");\n  const [newNumber, setNewNumber] = useState(\"\");\n  const [filterValue, setFilterValue] = useState(\"\");\n  const [newFilter, setNewFilter] = useState(true);\n  const [message, setMessage] = useState({ data: null, clases: \"\" });\n\n  useEffect(() => {\n    phonebook.getAll().then((response) => {\n      setPersons(response);\n    });\n  }, []);\n\n  const changeName = (event) => {\n    setNewName(event.target.value);\n  };\n  const changeNumber = (event) => {\n    setNewNumber(event.target.value);\n  };\n  const handleFilter = (event) => {\n    setFilterValue(event.target.value);\n    event.target.value ? setNewFilter(true) : setNewFilter(false);\n  };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    let newPerson = {\n      name: newName,\n      number: newNumber,\n    };\n    if (\n      persons.filter(\n        (person) => person.name.toLowerCase() === newName.toLowerCase()\n      ).length > 0 &&\n      persons.filter((person) => person.number === newNumber).length > 0\n    ) {\n      setMessage({ data: `${newName} already exist`, clases: \"message\" });\n      setTimeout(() => {\n        setMessage(null);\n      }, 5000);\n    } else if (\n      persons.filter(\n        (person) => person.name.toLowerCase() === newName.toLowerCase()\n      ).length > 0 &&\n      window.confirm(\n        `${newName} already exist do you wish to change the number?`\n      )\n    ) {\n      let id = persons.filter(\n        (person) => newName.toLowerCase() === person.name.toLowerCase()\n      )[0].id;\n      phonebook\n        .changePhone(id, newPerson)\n        .then((response) => {\n          setPersons(\n            persons.map((person) => (person.id !== id ? person : response))\n          );\n        })\n        .catch((err) =>\n          setMessage({\n            data: `${newName} has already been removed from server`,\n            clases: \"errorMessage\",\n          })\n        );\n      setMessage({\n        data: `${newName} phone number was changed`,\n        clases: \"errorMessage\",\n      });\n      setTimeout(() => {\n        setMessage(null);\n      }, 5000);\n    }\n    if (\n      persons.filter(\n        (person) => person.name.toLowerCase() === newName.toLowerCase()\n      ).length == 0\n    ) {\n      phonebook.newPerson(newPerson).then((response) => {\n        if (response.name) {\n          setPersons([...persons, response]);\n          setMessage({\n            data: `${response.name} was added to the phonebook`,\n            clases: \"message\",\n          });\n\n          setTimeout(() => {\n            setMessage(null);\n          }, 5000);\n        } else {\n          setMessage({\n            data: `${response.error}`,\n            clases: \"errorMessage\",\n          });\n          setTimeout(() => {\n            setMessage(null);\n          }, 7000);\n        }\n      });\n    }\n  };\n\n  const filter = persons.filter(\n    (person) =>\n      person.name.slice(0, filterValue.length).toLowerCase() ===\n      filterValue.toLowerCase()\n  );\n  //\n\n  const contactToShow = newFilter ? filter : persons;\n\n  const handleClick = (person) => {\n    let toDelete = [];\n    if (window.confirm(`delete ${person.name}?`)) {\n      toDelete = persons.slice(\n        persons.indexOf(person),\n        persons.indexOf(person) + 1\n      );\n      setPersons(persons.filter((person) => person.id !== toDelete[0].id));\n      phonebook.remove(toDelete[0].id);\n    }\n    setMessage({\n      data: `${toDelete[0].name} was deleted from phonebook`,\n      clases: \"errorMessage\",\n    });\n    setTimeout(() => {\n      setMessage(null);\n    }, 5000);\n  };\n\n  return (\n    <div>\n      <h2>Phonebook</h2>\n      {message ? (\n        <Notifications message={message.data} clases={message.clases} />\n      ) : (\n        <h2>Notifications</h2>\n      )}\n      <Filter handleFilter={handleFilter} />\n      <h1>Add a new number</h1>\n      <AddContact\n        handleSubmit={handleSubmit}\n        changeName={changeName}\n        changeNumber={changeNumber}\n      />\n      {\n        <Contacts\n          persons={contactToShow}\n          handleClick={(person) => handleClick(person)}\n        />\n      }\n    </div>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}